namespace = MEP_JLS

##############################
# COURT CHAPLAIN
# JOB: action_survey
##############################

# I've found some resources here!
character_event = {
	id = MEP_JLS.0
	hide_window = yes
	notification = no
	
	capable_only = yes
	prisoner = no
	
	trigger = {
		liege = {
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
		}
		has_job_action = action_survey
		location = {
			has_hidden_resources = yes
		}
	}
	
	mean_time_to_happen = {
		months = 48
		
		modifier = {
			factor = 2.0
			liege = {
				tier = count
			}
		}
		
		modifier = {
			factor = 1.25
			NOT = { learning = 2 }
			NOT = { stewardship = 2 }
		}
		modifier = {
			factor = 1.25
			NOT = { learning = 3 }
			NOT = { stewardship = 3 }
		}
		modifier = {
			factor = 1.25
			NOT = { learning = 4 }
			NOT = { stewardship = 4 }
		}
		modifier = {
			factor = 1.25
			NOT = { learning = 5 }
			NOT = { stewardship = 5 }
		}
		modifier = {
			factor = 0.75
			learning = 7
			stewardship = 7
		}
		modifier = {
			factor = 0.75
			learning = 8
			stewardship = 8
		}
		modifier = {
			factor = 0.75
			learning = 9
			stewardship = 9
		}
		modifier = {
			factor = 0.75
			learning = 10
			stewardship = 10
		}
		modifier = {
			factor = 0.75
			learning = 11
			stewardship = 11
		}
		modifier = {
			factor = 0.75
			learning = 12
			stewardship = 12
		}
		modifier = {
			factor = 0.75
			learning = 13
			stewardship = 13
		}
		modifier = {
			factor = 0.75
			learning = 14
			stewardship = 14
		}
	}
	
	immediate = {
	# sorted from ease to notice to difficulty to notice
		if = {
			limit = {
				location = { has_province_flag = flag_magma }
			}
			character_event = { id = MEP_JLS.6 }
			break = yes
		}
		if = {
			limit = {
				location = { has_province_flag = flag_copper }
			}
			character_event = { id = MEP_JLS.7 }
			break = yes
		}
		if = {
			limit = {
				location = { has_province_flag = flag_iron }
			}
			character_event = { id = MEP_JLS.8 }
			break = yes
		}
		if = {
			limit = {
				location = { has_province_flag = flag_salt }
			}
			character_event = { id = MEP_JLS.9 }
			break = yes
		}
		if = {
			limit = {
				location = { has_province_flag = flag_stone }
			}
			character_event = { id = MEP_JLS.10 }
			break = yes
		}
		if = {
			limit = {
				location = { has_province_flag = flag_tin }
			}
			character_event = { id = MEP_JLS.11 }
			break = yes
		}
		if = {
			limit = {
				location = { has_province_flag = flag_lapis }
			}
			character_event = { id = MEP_JLS.12 }
			break = yes
		}
		if = {
			limit = {
				location = { has_province_flag = flag_silver }
			}
			character_event = { id = MEP_JLS.13 }
			break = yes
		}
		if = {
			limit = {
				location = { has_province_flag = flag_gold }
			}
			character_event = { id = MEP_JLS.14 }
			break = yes
		}
		if = {
			limit = {
				location = { has_province_flag = flag_gemstones }
			}
			character_event = { id = MEP_JLS.15 }
			break = yes
		}
	}
	
	option = {
		name = EVTOPTAMEP_JLS.0
	}
}

# The steward is informed (iron)
character_event = {
	id = MEP_JLS.8
	desc = EVTDESCMEP_JLS.8
	picture = GFX_mim_prisoner_fealty
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.0
		hidden_tooltip = {
			liege = { character_event = { id = MEP_JLS.18 } }
		}
	}
}

# The liege is informed (iron)
character_event = {
	id = MEP_JLS.18
	desc = EVTDESCMEP_JLS.18
	picture = GFX_mim_prisoner_fealty
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.1
		
		FROM = {
			location = {
				clr_province_flag = flag_iron
				add_province_modifier = { name = resource_iron duration = -1 }
			}
		}
		
		opinion = {
			who = FROM
			modifier = opinion_grateful
			months = 60
		}
	}
}


# The steward is informed (magma)
character_event = {
	id = MEP_JLS.6
	desc = EVTDESCMEP_JLS.6
	picture = GFX_mim_prisoner_fealty
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.0
		hidden_tooltip = {
			liege = { character_event = { id = MEP_JLS.16 } }
		}
	}
}

# The liege is informed (magma)
character_event = {
	id = MEP_JLS.16
	desc = EVTDESCMEP_JLS.16
	picture = GFX_mim_prisoner_fealty
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.1
		
		FROM = {
			location = {
				clr_province_flag = flag_magma
				add_province_modifier = { name = resource_magma duration = -1 }
			}
		}
		
		opinion = {
			who = FROM
			modifier = opinion_grateful
			months = 60
		}
	}
}


# The steward is informed (copper)
character_event = {
	id = MEP_JLS.7
	desc = EVTDESCMEP_JLS.7
	picture = GFX_mim_prisoner_fealty
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.0
		hidden_tooltip = {
			liege = { character_event = { id = MEP_JLS.17 } }
		}
	}
}

# The liege is informed (copper)
character_event = {
	id = MEP_JLS.17
	desc = EVTDESCMEP_JLS.17
	picture = GFX_mim_prisoner_fealty
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.1
		
		FROM = {
			location = {
				clr_province_flag = flag_copper
				add_province_modifier = { name = resource_copper duration = -1 }
			}
		}
		
		opinion = {
			who = FROM
			modifier = opinion_grateful
			months = 60
		}
	}
}


# The steward is informed (tin)
character_event = {
	id = MEP_JLS.11
	desc = EVTDESCMEP_JLS.11
	picture = GFX_mim_prisoner_fealty
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.0
		hidden_tooltip = {
			liege = { character_event = { id = MEP_JLS.21 } }
		}
	}
}

# The liege is informed (tin)
character_event = {
	id = MEP_JLS.21
	desc = EVTDESCMEP_JLS.21
	picture = GFX_mim_prisoner_fealty
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.1
		
		FROM = {
			location = {
				clr_province_flag = flag_tin
				add_province_modifier = { name = resource_tin duration = -1 }
			}
		}
		
		opinion = {
			who = FROM
			modifier = opinion_grateful
			months = 60
		}
	}
}


# The steward is informed (stone)
character_event = {
	id = MEP_JLS.10
	desc = EVTDESCMEP_JLS.10
	picture = GFX_mim_prisoner_fealty
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.0
		hidden_tooltip = {
			liege = { character_event = { id = MEP_JLS.20 } }
		}
	}
}

# The liege is informed (stone)
character_event = {
	id = MEP_JLS.20
	desc = EVTDESCMEP_JLS.20
	picture = GFX_mim_prisoner_fealty
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.1
		
		FROM = {
			location = {
				clr_province_flag = flag_stone
				add_province_modifier = { name = resource_stone duration = -1 }
			}
		}
		
		opinion = {
			who = FROM
			modifier = opinion_grateful
			months = 60
		}
	}
}


# The steward is informed (gold)
character_event = {
	id = MEP_JLS.14
	desc = EVTDESCMEP_JLS.14
	picture = GFX_mim_prisoner_fealty
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.0
		hidden_tooltip = {
			liege = { character_event = { id = MEP_JLS.24 } }
		}
	}
}

# The liege is informed (gold)
character_event = {
	id = MEP_JLS.24
	desc = EVTDESCMEP_JLS.24
	picture = GFX_mim_prisoner_fealty
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.1
		
		FROM = {
			location = {
				clr_province_flag = flag_gold
				add_province_modifier = { name = resource_gold duration = -1 }
			}
		}
		
		opinion = {
			who = FROM
			modifier = opinion_grateful
			months = 60
		}
	}
}


# The steward is informed (silver)
character_event = {
	id = MEP_JLS.13
	desc = EVTDESCMEP_JLS.13
	picture = GFX_mim_prisoner_fealty
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.0
		hidden_tooltip = {
			liege = { character_event = { id = MEP_JLS.23 } }
		}
	}
}

# The liege is informed (silver)
character_event = {
	id = MEP_JLS.23
	desc = EVTDESCMEP_JLS.23
	picture = GFX_mim_prisoner_fealty
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.1
		
		FROM = {
			location = {
				clr_province_flag = flag_silver
				add_province_modifier = { name = resource_silver duration = -1 }
			}
		}
		
		opinion = {
			who = FROM
			modifier = opinion_grateful
			months = 60
		}
	}
}


# The steward is informed (gemstones)
character_event = {
	id = MEP_JLS.15
	desc = EVTDESCMEP_JLS.15
	picture = GFX_mim_prisoner_fealty
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.0
		hidden_tooltip = {
			liege = { character_event = { id = MEP_JLS.25 } }
		}
	}
}

# The liege is informed (gemstones)
character_event = {
	id = MEP_JLS.25
	desc = EVTDESCMEP_JLS.25
	picture = GFX_mim_prisoner_fealty
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.1
		
		FROM = {
			location = {
				clr_province_flag = flag_gemstones
				add_province_modifier = { name = resource_gemstones duration = -1 }
			}
		}
		
		opinion = {
			who = FROM
			modifier = opinion_grateful
			months = 60
		}
	}
}

# The steward is informed (lapis)
character_event = {
	id = MEP_JLS.12
	desc = EVTDESCMEP_JLS.12
	picture = GFX_mim_prisoner_fealty
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.0
		hidden_tooltip = {
			liege = { character_event = { id = MEP_JLS.22 } }
		}
	}
}

# The liege is informed (lapis)
character_event = {
	id = MEP_JLS.22
	desc = EVTDESCMEP_JLS.22
	picture = GFX_mim_prisoner_fealty
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.1
		
		FROM = {
			location = {
				clr_province_flag = flag_lapis
				add_province_modifier = { name = resource_lapis duration = -1 }
			}
		}
		
		opinion = {
			who = FROM
			modifier = opinion_grateful
			months = 60
		}
	}
}


# The steward is informed (salt)
character_event = {
	id = MEP_JLS.9
	desc = EVTDESCMEP_JLS.9
	picture = GFX_mim_prisoner_fealty
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.0
		hidden_tooltip = {
			liege = { character_event = { id = MEP_JLS.19 } }
		}
	}
}

# The liege is informed (salt)
character_event = {
	id = MEP_JLS.19
	desc = EVTDESCMEP_JLS.19
	picture = GFX_mim_prisoner_fealty
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.1
		
		FROM = {
			location = {
				clr_province_flag = flag_salt
				add_province_modifier = { name = resource_salt duration = -1 }
			}
		}
		
		opinion = {
			who = FROM
			modifier = opinion_grateful
			months = 60
		}
	}
}


# loremaster was arrested while surveying!
character_event = {
	id = MEP_JLS.2
	desc = EVTDESCMEP_JLS.2
	picture = GFX_evt_dwarves
	border = GFX_event_normal_frame_economy
	
	capable_only = yes
	prisoner = no
	
	trigger = {
		liege = {
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
		}
		has_job_action = action_survey
		location = {
			owner = {
				religion_group = religion_group_melkor
			}
		}
	}
	
	mean_time_to_happen = {
		months = 120
		
		modifier = {
			factor = 0.8
			NOT = { intrigue = 2 }
			NOT = { martial = 2 }
		}
		modifier = {
			factor = 0.8
			NOT = { intrigue = 3 }
			NOT = { martial = 3 }
		}
		modifier = {
			factor = 0.8
			NOT = { intrigue = 4 }
			NOT = { martial = 4 }
		}
		modifier = {
			factor = 0.8
			NOT = { intrigue = 5 }
			NOT = { martial = 5 }
		}
		modifier = {
			factor = 1.75
			intrigue = 7
			martial = 7
		}
		modifier = {
			factor = 1.75
			intrigue = 8
			martial = 8
		}
		modifier = {
			factor = 1.75
			intrigue = 9
			martial = 9
		}
		modifier = {
			factor = 1.75
			intrigue = 10
			martial = 10
		}
		modifier = {
			factor = 1.75
			intrigue = 11
			martial = 11
		}
		modifier = {
			factor = 1.75
			intrigue = 12
			martial = 12
		}
		modifier = {
			factor = 1.75
			intrigue = 13
			martial = 13
		}
		modifier = {
			factor = 1.75
			intrigue = 14
			martial = 14
		}
	}
		
	option = {
		name = EVTOPTAMEP_JLS.2
		prestige = -40
		
		# loremaster is imprisoned
		location = {
			owner = {
				ROOT = {
					imprison = PREV
				}
			}
		}
		
		hidden_tooltip  = {
			liege = { character_event = { id = MEP_JLS.3 } }
			location = { owner = { character_event = { id = MEP_JLS.4 } } }
		}
	}
}

# The liege is informed
character_event = {
	id = MEP_JLS.3
	desc = EVTDESCMEP_JLS.3
	picture = GFX_evt_dwarves
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.3
	}
}

# The owner is informed of imprisonment
character_event = {
	id = MEP_JLS.4
	desc = EVTDESCMEP_JLS.4
	picture = GFX_evt_dwarves
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAMEP_JLS.4
	}
}

#The owner is informed of resource discovery
character_event = {
	id = MEP_JLS.5
	desc = EVTDESCMEP_JLS.5
	picture = GFX_evt_dwarves
	border = GFX_event_normal_frame_economy
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTMEP_JLS_A.5
	
		prestige = 20

		trigger = {
			OR = {
				religion_group = religion_group_melkor
				trait = zealous
			}
		}
	}
	
	option = {
		name = EVTOPTMEP_JLS_B.5

		piety = 20

		trigger = {
			OR = {
				culture_group = culture_group_dwarves
				culture_group = culture_group_amanyar
				trait = dwarf_friend
			}
		}
	}
	
	option = {
		name = EVTOPTMEP_JLS_C.5
	
		prestige = -10

		trigger = {
			NOT = {
				culture_group = culture_group_dwarves
			}
		}
	}
}

# I've hired a dwarven prospector to survey my land

# The results are in from the dwarven prospector